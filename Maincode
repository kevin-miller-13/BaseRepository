This is the main code.
I have fixed the bug!!!
