This is the main code.
I have fixed the bug!!!
Now I have edited locally
Seans edit
